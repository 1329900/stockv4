

<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>เข้าสู่ระบบ</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Prompt', sans-serif;
            background-color: #f3f4f6;
        }
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .login-card {
            background-color: white;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 450px;
            overflow: hidden;
        }
        .login-header {
            background-color: #0f4c2e;
            color: white;
            padding: 1.5rem;
            text-align: center;
        }
        .form-group {
            margin-bottom: 1.5rem;
        }
        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            transition: all 0.3s;
        }
        .form-input:focus {
            outline: none;
            border-color: #0f4c2e;
            box-shadow: 0 0 0 3px rgba(15, 76, 46, 0.2);
        }
        .btn-login {
            background-color: #0f4c2e;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            width: 100%;
            font-weight: 600;
            transition: all 0.3s;
        }
        .btn-login:hover {
            background-color: #0a3622;
        }
        .btn-register {
            background-color: #4b5563;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            width: 100%;
            font-weight: 600;
            transition: all 0.3s;
        }
        .btn-register:hover {
            background-color: #374151;
        }
        .app-container {
            display: none;
        }
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #0f4c2e;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @font-face {
            font-family: 'Prompt';
            src: url('https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap');
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>

    <!-- Login Section -->
    <div id="loginSection" class="login-container">
        <div class="login-card">
            <div class="login-header">
                <h1 class="text-2xl font-bold">เข้าสู่ระบบ</h1>
                <p class="mt-2 text-sm opacity-80">กรุณาเข้าสู่ระบบเพื่อใช้งานแอปพลิเคชัน</p>
            </div>
            <div class="p-6">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="email" class="block text-sm font-medium text-gray-700 mb-1">อีเมล</label>
                        <input type="email" id="email" class="form-input" placeholder="กรอกอีเมลของคุณ" required>
                    </div>
                    <div class="form-group">
                        <label for="password" class="block text-sm font-medium text-gray-700 mb-1">รหัสผ่าน</label>
                        <input type="password" id="password" class="form-input" placeholder="กรอกรหัสผ่านของคุณ" required>
                    </div>
                    <div id="errorMessage" class="text-red-500 text-sm mb-4 hidden"></div>
                    <div class="form-group">
                        <button type="submit" class="btn-login">เข้าสู่ระบบ</button>
                    </div>
                </form>
                <div class="mt-4">
                    <p class="text-center text-gray-600 text-sm mb-4">หรือ</p>
                    <button id="registerBtn" class="btn-register">ลงทะเบียนใหม่</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Registration Modal -->
    <div id="registerModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg w-full max-w-md p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800">ลงทะเบียนผู้ใช้ใหม่</h2>
                <button id="closeRegisterModal" class="text-gray-500 hover:text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <form id="registerForm">
                <div class="form-group">
                    <label for="registerEmail" class="block text-sm font-medium text-gray-700 mb-1">อีเมล</label>
                    <input type="email" id="registerEmail" class="form-input" placeholder="กรอกอีเมลของคุณ" required>
                </div>
                <div class="form-group">
                    <label for="registerPassword" class="block text-sm font-medium text-gray-700 mb-1">รหัสผ่าน</label>
                    <input type="password" id="registerPassword" class="form-input" placeholder="กรอกรหัสผ่านของคุณ" required>
                </div>
                <div class="form-group">
                    <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-1">ยืนยันรหัสผ่าน</label>
                    <input type="password" id="confirmPassword" class="form-input" placeholder="กรอกรหัสผ่านอีกครั้ง" required>
                </div>
                <div id="registerErrorMessage" class="text-red-500 text-sm mb-4 hidden"></div>
                <div class="form-group">
                    <button type="submit" class="btn-login">ลงทะเบียน</button>
                </div>
            </form>
        </div>
    </div>

    <!-- App Container - Your web app will be loaded here -->
    <div id="appContainer" class="app-container">
        <!-- Your web app HTML will be placed here after successful login -->
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCV0T11S2xJZzRxq1wKlIYLKC2ZMbppDR0",
            authDomain: "epidbma-7ace1.firebaseapp.com",
            databaseURL: "https://epidbma-7ace1-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "epidbma-7ace1",
            storageBucket: "epidbma-7ace1.firebasestorage.app",
            messagingSenderId: "256371121756",
            appId: "1:256371121756:web:904b80ff04948ab7d0d099",
            measurementId: "G-M7MXGGVPRV"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        // DOM Elements
        const loginSection = document.getElementById('loginSection');
        const appContainer = document.getElementById('appContainer');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const registerBtn = document.getElementById('registerBtn');
        const registerModal = document.getElementById('registerModal');
        const closeRegisterModal = document.getElementById('closeRegisterModal');
        const errorMessage = document.getElementById('errorMessage');
        const registerErrorMessage = document.getElementById('registerErrorMessage');
        const loadingOverlay = document.getElementById('loadingOverlay');

        // Show loading
        function showLoading() {
            loadingOverlay.style.display = 'flex';
        }

        // Hide loading
        function hideLoading() {
            loadingOverlay.style.display = 'none';
        }

        // Check if user is already logged in
        auth.onAuthStateChanged(function(user) {
            if (user) {
                // User is signed in
                showApp();
            } else {
                // No user is signed in
                showLogin();
            }
        });

        // Login form submission
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            showLoading();
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // Signed in
                    hideLoading();
                    showApp();
                })
                .catch((error) => {
                    hideLoading();
                    errorMessage.textContent = getErrorMessage(error.code);
                    errorMessage.classList.remove('hidden');
                });
        });

        // Register form submission
        registerForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (password !== confirmPassword) {
                registerErrorMessage.textContent = 'รหัสผ่านไม่ตรงกัน กรุณาตรวจสอบอีกครั้ง';
                registerErrorMessage.classList.remove('hidden');
                return;
            }
            
            showLoading();
            
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // Signed up
                    hideLoading();
                    registerModal.classList.add('hidden');
                    showApp();
                })
                .catch((error) => {
                    hideLoading();
                    registerErrorMessage.textContent = getErrorMessage(error.code);
                    registerErrorMessage.classList.remove('hidden');
                });
        });

        // Register button click
        registerBtn.addEventListener('click', function() {
            registerModal.classList.remove('hidden');
        });

        // Close register modal
        closeRegisterModal.addEventListener('click', function() {
            registerModal.classList.add('hidden');
        });

        // Close modal when clicking outside
        window.addEventListener('click', function(e) {
            if (e.target === registerModal) {
                registerModal.classList.add('hidden');
            }
        });

        // Show login section
        function showLogin() {
            loginSection.style.display = 'flex';
            appContainer.style.display = 'none';
        }

        // Show app section
        function showApp() {
            loginSection.style.display = 'none';
            appContainer.style.display = 'block';
            
            // Load your web app here
            // This is where you would insert your web app code
            loadWebApp();
        }

        // Load web app function
        function loadWebApp() {
            // This function will load your web app into the appContainer
            // You will replace this with your actual web app code
            
            // For now, we'll just show a placeholder
            appContainer.innerHTML = `
<div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-white shadow-md">
            <div class="container mx-auto px-4 py-3 flex justify-between items-center">
                <div class="flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-[#0F4C3A]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                    </svg>
                    <h1 class="ml-2 text-xl font-bold text-[#0F4C3A]">ระบบจัดการคลังพัสดุ - กลุ่มงานระบาดวิทยา</h1>
                </div>
                <div class="text-sm text-gray-600" id="current-date-time"></div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="flex flex-1">
            <!-- Sidebar -->
            <aside class="w-64 bg-white shadow-md p-4">
                <nav>
                    <div class="nav-item active" data-page="stock">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                        </svg>
                        สต๊อกพัสดุ
                    </div>
                    <div class="nav-item" data-page="withdraw">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                        </svg>
                        เบิกพัสดุ
                    </div>
                    <div class="nav-item" data-page="receive">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        รับพัสดุ
                    </div>
                    <div class="nav-item" data-page="history">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        ประวัติการเบิก-รับ
                    </div>
                </nav>
            </aside>

            <!-- Content Area -->
            <main class="flex-1 p-6 overflow-auto">
                <!-- Stock Page -->
                <div id="stock-page" class="page">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-[#0F4C3A]">สต๊อกพัสดุ</h2>
                        <div>
                            <button id="add-item-btn" class="btn-primary">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                                </svg>
                                เพิ่มรายการพัสดุ
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                        <div class="mb-4">
                            <input type="text" id="stock-search" placeholder="ค้นหารายการพัสดุ..." class="w-full p-2 border border-gray-300 rounded-md">
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table id="stock-table" class="min-w-full">
                                <thead>
                                    <tr>
                                        <th>รหัสบาร์โค้ด</th>
                                        <th>รายการพัสดุ</th>
                                        <th>จำนวนคงเหลือ</th>
                                        <th>หน่วยนับ</th>
                                        <th>วันหมดอายุ</th>
                                        <th>สถานะ</th>
                                        <th>จัดการ</th>
                                    </tr>
                                </thead>
                                <tbody id="stock-table-body">
                                    <!-- Stock items will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Withdraw Page -->
                <div id="withdraw-page" class="page hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-[#0F4C3A]">เบิกพัสดุ</h2>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <div>
                                <label class="block text-gray-700 mb-2">ชื่อผู้เบิก</label>
                                <input type="text" id="withdraw-name" class="w-full p-2 border border-gray-300 rounded-md">
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">ตำแหน่ง</label>
                                <input type="text" id="withdraw-position" class="w-full p-2 border border-gray-300 rounded-md">
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <label class="block text-gray-700 mb-2">วัตถุประสงค์การใช้</label>
                            <textarea id="withdraw-purpose" class="w-full p-2 border border-gray-300 rounded-md" rows="2"></textarea>
                        </div>
                        
                        <div class="mb-6">
                            <label class="block text-gray-700 mb-2">แสกนบาร์โค้ด</label>
                            <input type="text" id="withdraw-barcode" class="barcode-input" placeholder="แสกนบาร์โค้ดที่นี่..." autofocus>
                        </div>
                        
                        <div class="overflow-x-auto mb-6">
                            <table class="min-w-full">
                                <thead>
                                    <tr>
                                        <th>รหัสบาร์โค้ด</th>
                                        <th>รายการพัสดุ</th>
                                        <th>จำนวนคงเหลือ</th>
                                        <th>จำนวนที่เบิก</th>
                                        <th>หน่วยนับ</th>
                                        <th>ลบ</th>
                                    </tr>
                                </thead>
                                <tbody id="withdraw-items">
                                    <!-- Withdraw items will be populated here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="flex justify-end">
                            <button id="withdraw-submit" class="btn-primary">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                </svg>
                                บันทึกการเบิก
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Receive Page -->
                <div id="receive-page" class="page hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-[#0F4C3A]">รับพัสดุ</h2>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <div>
                                <label class="block text-gray-700 mb-2">แหล่งที่มา</label>
                                <input type="text" id="receive-source" class="w-full p-2 border border-gray-300 rounded-md">
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">ผู้รับ</label>
                                <input type="text" id="receive-receiver" class="w-full p-2 border border-gray-300 rounded-md">
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <label class="block text-gray-700 mb-2">แสกนบาร์โค้ด (สำหรับพัสดุที่มีในระบบ)</label>
                            <input type="text" id="receive-barcode" class="barcode-input" placeholder="แสกนบาร์โค้ดที่นี่..." autofocus>
                        </div>
                        
                        <div class="overflow-x-auto mb-6">
                            <table class="min-w-full">
                                <thead>
                                    <tr>
                                        <th>รหัสบาร์โค้ด</th>
                                        <th>รายการพัสดุ</th>
                                        <th>จำนวนที่รับ</th>
                                        <th>หน่วยนับ</th>
                                        <th>วันหมดอายุ</th>
                                        <th>ลบ</th>
                                    </tr>
                                </thead>
                                <tbody id="receive-items">
                                    <!-- Receive items will be populated here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="flex justify-between">
                            <button id="add-new-item-btn" class="btn-secondary">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                                </svg>
                                เพิ่มรายการใหม่
                            </button>
                            <button id="receive-submit" class="btn-primary">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                </svg>
                                บันทึกการรับ
                            </button>
                        </div>
                    </div>
                </div>

                <!-- History Page -->
                <div id="history-page" class="page hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-[#0F4C3A]">ประวัติการเบิก-รับ</h2>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                        <div class="flex flex-wrap gap-4 mb-6">
                            <div>
                                <label class="block text-gray-700 mb-2">ประเภท</label>
                                <select id="history-type" class="p-2 border border-gray-300 rounded-md">
                                    <option value="all">ทั้งหมด</option>
                                    <option value="withdraw">การเบิก</option>
                                    <option value="receive">การรับ</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">จากวันที่</label>
                                <input type="date" id="history-start-date" class="p-2 border border-gray-300 rounded-md">
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">ถึงวันที่</label>
                                <input type="date" id="history-end-date" class="p-2 border border-gray-300 rounded-md">
                            </div>
                            <div class="flex items-end">
                                <button id="history-search" class="btn-primary">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                    </svg>
                                    ค้นหา
                                </button>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                    <tr>
                                        <th>วันที่</th>
                                        <th>เวลา</th>
                                        <th>ประเภท</th>
                                        <th>ผู้ดำเนินการ</th>
                                        <th>รายละเอียด</th>
                                        <th>จัดการ</th>
                                    </tr>
                                </thead>
                                <tbody id="history-items">
                                    <!-- History items will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Add/Edit Item Modal -->
    <div id="item-modal" class="modal">
        <div class="modal-content">
            <h3 class="text-xl font-bold text-[#0F4C3A] mb-4" id="modal-title">เพิ่มรายการพัสดุ</h3>
            
            <div class="mb-4">
                <label class="block text-gray-700 mb-2">รหัสบาร์โค้ด</label>
                <input type="text" id="item-barcode" class="w-full p-2 border border-gray-300 rounded-md">
            </div>
            
            <div class="mb-4">
                <label class="block text-gray-700 mb-2">รายการพัสดุ</label>
                <input type="text" id="item-name" class="w-full p-2 border border-gray-300 rounded-md">
            </div>
            
            <div class="mb-4">
                <label class="block text-gray-700 mb-2">จำนวน</label>
                <input type="number" id="item-quantity" class="w-full p-2 border border-gray-300 rounded-md" min="0">
            </div>
            
            <div class="mb-4">
                <label class="block text-gray-700 mb-2">หน่วยนับ</label>
                <input type="text" id="item-unit" class="w-full p-2 border border-gray-300 rounded-md">
            </div>
            
            <div class="mb-4">
                <label class="block text-gray-700 mb-2">วันหมดอายุ (ถ้ามี)</label>
                <input type="date" id="item-expiry" class="w-full p-2 border border-gray-300 rounded-md">
            </div>
            
            <div class="flex justify-end gap-2">
                <button id="modal-cancel" class="btn-secondary">ยกเลิก</button>
                <button id="modal-save" class="btn-primary">บันทึก</button>
            </div>
        </div>
    </div>

    <!-- Receipt Modal -->
    <div id="receipt-modal" class="modal">
        <div class="modal-content">
            <div id="receipt-content" class="receipt">
                <div class="receipt-header">
                    <h2 class="text-xl font-bold">กลุ่มงานระบาดวิทยา</h2>
                    <p id="receipt-title" class="text-lg">ใบเบิกพัสดุ</p>
                    <p id="receipt-date"></p>
                </div>
                
                <div class="mb-4">
                    <p id="receipt-person"></p>
                    <p id="receipt-details"></p>
                </div>
                
                <table class="receipt-table">
                    <thead>
                        <tr>
                            <th>ลำดับ</th>
                            <th>รหัสบาร์โค้ด</th>
                            <th>รายการพัสดุ</th>
                            <th>จำนวน</th>
                            <th>หน่วยนับ</th>
                        </tr>
                    </thead>
                    <tbody id="receipt-items">
                        <!-- Receipt items will be populated here -->
                    </tbody>
                </table>
                
                <div class="receipt-footer">
                    <div class="signature">
                        <div class="signature-line"></div>
                        <p>ผู้เบิก/ผู้รับ</p>
                    </div>
                    <div class="signature">
                        <div class="signature-line"></div>
                        <p>ผู้จ่าย/ผู้บันทึก</p>
                    </div>
                </div>
            </div>
            
            <div class="flex justify-end gap-2 mt-4">
                <button id="receipt-print" class="btn-secondary">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
                    </svg>
                    พิมพ์
                </button>
                <button id="receipt-pdf" class="btn-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                    </svg>
                    บันทึก PDF
                </button>
                <button id="receipt-close" class="btn-secondary">ปิด</button>
            </div>
        </div>
    </div>
            `;
            
            // Add logout functionality
            document.getElementById('logoutBtn').addEventListener('click', function() {
                auth.signOut().then(() => {
                    showLogin();
                }).catch((error) => {
                    console.error('Error signing out:', error);
                });
            });
        }

        // Error message helper
        function getErrorMessage(errorCode) {
            switch(errorCode) {
                case 'auth/invalid-email':
                    return 'รูปแบบอีเมลไม่ถูกต้อง';
                case 'auth/user-disabled':
                    return 'บัญชีผู้ใช้นี้ถูกระงับการใช้งาน';
                case 'auth/user-not-found':
                    return 'ไม่พบบัญชีผู้ใช้นี้';
                case 'auth/wrong-password':
                    return 'รหัสผ่านไม่ถูกต้อง';
                case 'auth/email-already-in-use':
                    return 'อีเมลนี้ถูกใช้งานแล้ว';
                case 'auth/weak-password':
                    return 'รหัสผ่านไม่ปลอดภัย กรุณาใช้รหัสผ่านที่มีความยาวอย่างน้อย 6 ตัวอักษร';
                default:
                    return 'เกิดข้อผิดพลาด: ' + errorCode;
            }
        }

        // Prevent form resubmission on page refresh
        if (window.history.replaceState) {
            window.history.replaceState(null, null, window.location.href);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9544eb463132f92c',t:'MTc1MDY5MTQ5OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
